function computeReachableFrom(startX, startY) {
  const start = worldToTile(startX, startY);
  const reachable = Array.from({ length: MAP_H }, () => Array(MAP_W).fill(false));
  const q = [{ tx: start.tx, ty: start.ty }];
  reachable[start.ty][start.tx] = true;

  const dirs = [
    {x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1},
  ];

  while (q.length) {
    const { tx, ty } = q.shift();
    for (const d of dirs) {
      const nx = tx + d.x, ny = ty + d.y;
      if (nx < 0 || ny < 0 || nx >= MAP_W || ny >= MAP_H) continue;
      if (reachable[ny][nx]) continue;
      if (isWallTile(nx, ny)) continue;
      reachable[ny][nx] = true;
      q.push({ tx: nx, ty: ny });
    }
  }

  // Create a flat list for easy random selection:
  const tiles = [];
  for (let y = 0; y < MAP_H; y++) {
    for (let x = 0; x < MAP_W; x++) {
      if (reachable[y][x]) tiles.push({ tx: x, ty: y });
    }
  }
  return { reachable, tiles };
}

// call once after player is placed:
const REACH = computeReachableFrom(player.x, player.y);
